2025-06-27 12:28:05 - 2025-06-27 12:28:05 - Iniciando aplicação...
2025-06-27 12:28:05 - ****registrar_log_tarefa_executada() tarefa_executada = False
2025-06-27 12:28:05 - thread_ativa.txt atualizado para True
2025-06-27 12:28:09 - Botao executar clicado! - tarefa executada: False, tarefa_executada_erro:False
2025-06-27 12:28:09 - Tarefa inicializada! 
bt_executar desativado!
2025-06-27 12:28:10 - Main()
2025-06-27 12:28:10 - Encontrar_diretorio_instantclient
2025-06-27 12:28:10 - Caminho base do executavel: C:\Pietro\Projetos\RPA_PRESCR_EM_PDF
2025-06-27 12:28:10 - caminho instantclient:
C:\Pietro\Projetos\RPA_PRESCR_EM_PDF\instantclient-basiclite-windows.x64-23.6.0.24.10\instantclient_23_6
2025-06-27 12:28:10 - Encontrar_diretorio_instantclient
2025-06-27 12:28:10 - Caminho base do executavel: C:\Pietro\Projetos\RPA_PRESCR_EM_PDF
2025-06-27 12:28:10 - caminho instantclient:
C:\Pietro\Projetos\RPA_PRESCR_EM_PDF\instantclient-basiclite-windows.x64-23.6.0.24.10\instantclient_23_6
2025-06-27 12:28:10 - Executando a query
2025-06-27 12:28:11 - Atendimentos sample:    NR_ATENDIMENTO
0          723873
2025-06-27 12:28:12 - Atendimentos data frame:(1, 1)
2025-06-27 12:28:13 - Atendimentos obtido com sucesso!
2025-06-27 12:28:15 - Main() df_filtrado tamanho: (1, 1)
2025-06-27 12:28:15 - Geracao_Pdf_Prescricao((1, 1))
2025-06-27 12:28:15 - Geracao de Pdf ()
2025-06-27 12:28:15 - 
df_filtrado:
   NR_ATENDIMENTO
0          723873
2025-06-27 12:28:15 - contador:0
contador_linhas_df: 1
2025-06-27 12:28:15 - Inicio da repetição
2025-06-27 12:28:15 - Repeticao for index iterrows()
2025-06-27 12:28:15 - Adicionando a lista o nr_atendimento:723873
2025-06-27 12:28:15 - Geracao Pdf Prescricao - contador:0
2025-06-27 12:28:15 - Geracao_Pdf_Prescricao() - try:
2025-06-27 12:28:15 - options = Options() # Inicializa as opções do Chrome 
2025-06-27 12:28:15 - Configurando opções do Chrome para download automático.
2025-06-27 12:28:20 - cpoe_url: http://aplicacao.hsf.local:7070/#/login
2025-06-27 12:28:20 - Obtendo credenciais do config.ini...
2025-06-27 12:28:20 - Obter_credenciais_login() - lendo do config.ini
2025-06-27 12:28:20 - Aguardando campo de usuário...
2025-06-27 12:28:20 - Campo de usuário preenchido.
2025-06-27 12:28:20 - Campo de senha preenchido.
2025-06-27 12:28:20 - Aguardando botão de login...
2025-06-27 12:28:21 - Login realizado com sucesso.
2025-06-27 12:28:21 - Lógica para tratar pop-up de "Ok" opcional
2025-06-27 12:28:21 - Verificando se há um pop-up de 'Ok' após o login...
2025-06-27 12:28:23 - Pop-up de 'Ok' encontrado. Clicando no botão para prosseguir.
2025-06-27 12:28:23 - Aguardando o ícone do CPOE ficar clicável...
2025-06-27 12:28:25 - Ícone do CPOE clicado com sucesso.
2025-06-27 12:28:25 - Aguardando o campo de número de atendimento...
2025-06-27 12:28:30 - Número de atendimento preenchido: 723873
2025-06-27 12:28:31 - Enter pressionado no campo de atendimento para submeter.
2025-06-27 12:28:31 - Aguardando botão 'Ok' após submeter o atendimento...
2025-06-27 12:28:32 - Botão 'Ok' encontrado. Clicando para prosseguir.
2025-06-27 12:28:32 - Verificando se há um pop-up de 'Fechar' (atendimento fechado)...
2025-06-27 12:28:37 - Nenhum pop-up de 'Fechar' encontrado ou a página já navegou. Prosseguindo...
2025-06-27 12:28:37 - Aguardando o botão "Relatórios" (handlebar-40) ficar clicável...
2025-06-27 12:28:37 - Botão 'Relatórios' clicado com sucesso.
2025-06-27 12:28:37 - Aguardando o botão "Visualizar" (popupViewPort) ficar clicável...
2025-06-27 12:28:37 - Botão 'Visualizar' clicado com sucesso.
2025-06-27 12:28:37 - Obter coordenadas do botão "manter" do config.ini
2025-06-27 12:28:37 - time.sleep(2)
2025-06-27 12:28:39 - click no manter - 1751, 108
2025-06-27 12:28:39 - time.sleep(2)
2025-06-27 12:28:41 - click no manter - 1751, 108
2025-06-27 12:28:41 - time.sleep(6.0)
2025-06-27 12:28:47 - driver.quit()

2025-06-27 12:28:50 - acessando pasta download:
2025-06-27 12:28:50 - Caminho da pasta download: C:\Users\pvplima.C19NOT76\Downloads
2025-06-27 12:28:52 - verificando arquivos da pasta download:
2025-06-27 12:28:52 - Arquivos:
['1dedef11-171b-443a-8966-c1b456e2c590.pdf']
2025-06-27 12:28:54 - ultimo arquivo antes de renomear:
2025-06-27 12:28:54 - Ultimo arquivo antes de renomear: C:\Users\pvplima.C19NOT76\Downloads\1dedef11-171b-443a-8966-c1b456e2c590.pdf
2025-06-27 12:28:57 - pasta_prescricoes: Prescricoes
2025-06-27 12:28:59 - pasta_data: Prescricoes\2025_06_27
2025-06-27 12:29:02 - Cria a pasta da data se não existir: Prescricoes\2025_06_27
2025-06-27 12:29:04 - renomeia e move os arquivos
2025-06-27 12:29:04 - Data_hora: 2025-06-27 12:29:04
2025-06-27 12:29:04 - caminho antigo: C:\Users\pvplima.C19NOT76\Downloads\1dedef11-171b-443a-8966-c1b456e2c590.pdf
2025-06-27 12:29:04 - caminho_novo = Prescricoes\2025_06_27\723873 - 2025-06-27 12-29-04.pdf,arquivo:2025-06-27 12-29-04.pdf)
2025-06-27 12:29:04 - try: shutil.move(
 time.sleep(TEMPO_ESPERA/5)
2025-06-27 12:29:06 - caminho_antigo:C:\Users\pvplima.C19NOT76\Downloads\1dedef11-171b-443a-8966-c1b456e2c590.pdf, 
caminho_novoPrescricoes\2025_06_27\723873 - 2025-06-27 12-29-04.pdf)
2025-06-27 12:29:06 - Arquivo:Prescricoes\2025_06_27\723873 - 2025-06-27 12-29-04.pdf Renomeado e movido com sucesso.
2025-06-27 12:29:09 - Contador: 1
2025-06-27 12:29:09 - lista_nr_atendimento.remove(723873)
2025-06-27 12:29:09 - ******************** FIM do 723873 ********************
2025-06-27 12:29:10 - tarefa_executada: True
2025-06-27 12:29:10 - tarefa_executada_erro: False
2025-06-27 12:29:10 - se ocorrer um erro na execução
definimos que a variavel tarefa_executada sera False
 para que a tarefa possa ser executada novamente:
2025-06-27 12:29:10 - ===== try:
Lista com nr_atendimentos com erro
2025-06-27 12:29:10 - 
Todos os atendimentos foram gerados com sucesso!
2025-06-27 12:29:10 - def Geracao_PDF_Prescricao() 
bloco com funcao copiar_arquivos()
2025-06-27 12:29:10 - def copiar_arquivos()
2025-06-27 12:29:10 - base_dir: C:\Pietro\Projetos\RPA_PRESCR_EM_PDF
2025-06-27 12:29:10 - Caminho de origem: C:\Pietro\Projetos\RPA_PRESCR_EM_PDF\Prescricoes
2025-06-27 12:29:10 - Caminho de destino: \\192.168.103.252\\contingencia_hsf$\\Impressos\\Prescricoes
2025-06-27 12:29:10 - shutil.copytree(origem, destino, dirs_exist_ok=True)
2025-06-27 12:29:11 - 
Arquivos copiados com sucesso 
de: C:\Pietro\Projetos\RPA_PRESCR_EM_PDF\Prescricoes 
para \\192.168.103.252\\contingencia_hsf$\\Impressos\\Prescricoes
FIM copiar_arquivos()
2025-06-27 12:29:11 - df_: 
[]
2025-06-27 12:29:11 - Geracao Pdf Prescricao
ANTES:
Tarefa_executada: True
Tarefa_executada_erro:False
2025-06-27 12:29:11 - Geracao Pdf Prescricao
DEPOIS:
Tarefa_executada: False
Tarefa_executada_erro:False
2025-06-27 12:29:11 - FIM Geracao_Pdf_Prescricao(df_)

2025-06-27 12:29:11 - Prescrições geradas!
2025-06-27 12:29:11 - ****registrar_log_tarefa_executada() tarefa_executada = True
2025-06-27 12:29:11 - FIM DA EXECUÇÃO
2025-06-27 12:30:15 - 2025-06-27 12:30:15 - Iniciando aplicação...
2025-06-27 12:30:15 - ****registrar_log_tarefa_executada() tarefa_executada = False
2025-06-27 12:30:15 - thread_ativa.txt atualizado para True
2025-06-27 12:30:20 - thread_ativa: True
2025-06-27 12:30:20 - Fechando aplicação...
2025-06-27 12:30:20 - thread_ativa.txt atualizado para False
